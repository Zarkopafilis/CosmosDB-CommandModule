@page "/collectionscaler"
@using CosmosDBCommandModule.Shared.Models
@inject HttpClient Http

<h1>Collection scaler</h1>

@if (_cosmosDatabases != null)
{
    foreach (var cosmosDatabase in _cosmosDatabases)
    {
        <div>Database: @cosmosDatabase.Id</div>

        if (cosmosDatabase.Collections != null)
        {
            foreach (var cosmosCollection in cosmosDatabase.Collections)
            {
                <div>Collection with id @cosmosCollection.Id and throughput @cosmosCollection.Offer.Throughput RU/s</div>
            }
        }
    }
}

@functions
{
private List<CosmosDatabase> _cosmosDatabases;


protected override async Task OnInitAsync()
{
    _cosmosDatabases = await Http.GetJsonAsync<List<CosmosDatabase>>($"api/databases?withCollections=true&withOffers=true");
}

}
